{% extends 'bodega/base.html' %}
{% load permisos_tags %}

{% block title %}
  {% if object.estado == 'cancelado' %}
    Confirmar Reactivación - Bodega Eirete
  {% else %}
    Confirmar Cancelación - Bodega Eirete
  {% endif %}
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-6 offset-md-3">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h2 class="card-title mb-4">
          {% if object.estado == 'cancelado' %}
            Confirmar Reactivación
          {% else %}
            Confirmar Cancelación
          {% endif %}
        </h2>

        {% if request.user|tiene_permiso:"cancelar_pedido" %}
        <p>
          {% if object.estado == 'cancelado' %}
            ¿Estás seguro de que deseas <strong>reactivar</strong> el pedido <strong>#{{ object.pk }}</strong> del cliente <strong>{{ object.cliente }}</strong>?
          {% else %}
            ¿Estás seguro de que deseas <strong>cancelar</strong> el pedido <strong>#{{ object.pk }}</strong> del cliente <strong>{{ object.cliente }}</strong>?
          {% endif %}
        </p>

        <form method="post">
          {% csrf_token %}
          <button type="submit" class="btn {% if object.estado == 'cancelado' %}btn-success{% else %}btn-danger{% endif %}">
            {% if object.estado == 'cancelado' %}Reactivar{% else %}Cancelar{% endif %}
          </button>
          <a href="{% url 'pedido_list' %}" class="btn btn-secondary">Volver</a>
        </form>
        {% else %}
        <div class="alert alert-warning">
          No tienes permiso para realizar esta acción.
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
