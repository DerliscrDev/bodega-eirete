{% extends 'bodega/base.html' %}

{% block content %}
<div class="container mt-4">
  <div class="border p-4" style="width: 21cm; margin: auto; background-color: white;">
    <div class="text-center">
      <h4 class="mb-0">BODEGA EIRETE</h4>
      <p class="mb-0">RUC: 1234567-8</p>
      <p class="mb-0">Av. Ejemplo 123 - Asunción - Paraguay</p>
      <p>Tel: (021) 123-4567</p>
    </div>

    <hr>

    <div class="d-flex justify-content-between mb-3">
      <div>
        <p><strong>Timbrado:</strong> {{ factura.timbrado }}</p>
        <p><strong>Factura Nro:</strong> {{ factura.nro_factura }}</p>
        <p><strong>Condición de venta:</strong> {{ factura.get_condicion_venta_display }}</p>
      </div>
      <div>
        <p><strong>Fecha:</strong> {{ factura.fecha|date:"d/m/Y H:i" }}</p>
        <p><strong>Cliente:</strong> {{ factura.cliente }}</p>
        <p><strong>RUC/CI:</strong> {{ factura.cliente.documento }}</p>
      </div>
    </div>

    <table class="table table-bordered table-sm">
      <thead class="table-light">
        <tr class="text-center">
          <th>Código</th>
          <th>Descripción</th>
          <th>Cant.</th>
          <th>Precio Unitario</th>
          <th>Exenta</th>
          <th>IVA 5%</th>
          <th>IVA 10%</th>
        </tr>
      </thead>
      <tbody>
        {% for d in factura.detalles.all %}
        <tr class="text-end">
          <td>{{ d.producto.codigo }}</td>
          <td class="text-start">{{ d.producto.nombre }}</td>
          <td>{{ d.cantidad }}</td>
          <td>Gs. {{ d.precio_unitario }}</td>
          <td>{% if d.iva_aplicado == "exento" %}Gs. {{ d.cantidad|mul:d.precio_unitario }}{% endif %}</td>
          <td>{% if d.iva_aplicado == "5" %}Gs. {{ d.cantidad|mul:d.precio_unitario }}{% endif %}</td>
          <td>{% if d.iva_aplicado == "10" %}Gs. {{ d.cantidad|mul:d.precio_unitario }}{% endif %}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="text-end mt-3">
      <p><strong>Total:</strong> Gs. {{ factura.total }}</p>
      <p><strong>Total en letras:</strong> {{ factura.total|numero_a_letras }}</p>
    </div>

    <div class="mt-5">
      <p>____________________________</p>
      <p>Firma y aclaración</p>
    </div>
  </div>
</div>
{% endblock %}