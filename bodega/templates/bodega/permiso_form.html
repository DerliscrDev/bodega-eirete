{% extends "bodega/base.html" %}
{% load permisos_tags %}
{% block title %}{% if object %}Editar Permiso{% else %}Nuevo Permiso{% endif %} - Bodega Eirete{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-8 col-md-10">
    <div class="card shadow-sm">
      <div class="card-body">
        <h4 class="mb-3">{% if object %}Editar Permiso{% else %}Nuevo Permiso{% endif %}</h4>
          <form method="post" novalidate>
            {% csrf_token %}
            {{ form.non_field_errors }}

            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label" for="{{ form.codigo.id_for_label }}">{{ form.codigo.label }}</label>
                {{ form.codigo }}
                <div class="form-text">Ej.: <code>permisos.ver</code></div>
                {{ form.codigo.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.nombre.id_for_label }}">{{ form.nombre.label }}</label>
                {{ form.nombre }}
                {{ form.nombre.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.modulo.id_for_label }}">{{ form.modulo.label }}</label>
                {{ form.modulo }}
                {{ form.modulo.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.accion.id_for_label }}">{{ form.accion.label }}</label>
                {{ form.accion }}
                {{ form.accion.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.url_name.id_for_label }}">{{ form.url_name.label }}</label>
                {{ form.url_name }}
                {{ form.url_name.errors }}
              </div>

              {% if object %}
                <div class="mb-3 d-flex align-items-center gap-2">
                  <label class="form-label m-0">Estado</label>
                  {% if object.activo %}
                    <span class="badge bg-success">Activo</span>
                    <a href="{% url 'permiso_inactivate' object.pk %}" class="btn btn-sm btn-outline-warning ms-2">
                      <i class="bi-x-circle"></i> Inactivar
                    </a>
                  {% else %}
                    <span class="badge bg-secondary">Inactivo</span>
                    <a href="{% url 'permiso_inactivate' object.pk %}" class="btn btn-sm btn-outline-success ms-2">
                      <i class="bi bi-check-circle"></i> Reactivar
                    </a>
                  {% endif %}
                </div>
              {% endif %}
            </div>
            <div class="mt-4">
              <button class="btn btn-custom" type="submit">
                {% if object %}Actualizar{% else %}Guardar{% endif %}
              </button>
              <a href="{% url 'permiso_list' %}" class="btn btn-secondary">Cancelar</a>
            </div>
          </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
