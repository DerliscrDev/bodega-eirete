{% extends "bodega/base.html" %}
{% load permisos_tags %}
{% block title %}{% if object %}Editar Permiso{% else %}Nuevo Permiso{% endif %} - Bodega Eirete{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-8 col-md-10">
    <div class="card shadow-sm">
      <div class="card-body">
        <h4 class="mb-3">{% if object %}Editar Permiso{% else %}Nuevo Permiso{% endif %}</h4>

        {% comment %} {% if request.user|tiene_permiso:"permisos.crear_permiso" or request.user|tiene_permiso:"permisos.editar_permiso" or request.user|tiene_permiso:"crear_permiso" or request.user|tiene_permiso:"editar_permiso" %} {% endcomment %}
          <form method="post" novalidate>
            {% csrf_token %}
            {{ form.non_field_errors }}

            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label" for="{{ form.codigo.id_for_label }}">{{ form.codigo.label }}</label>
                {{ form.codigo }}
                <div class="form-text">Ej.: <code>permisos.ver</code></div>
                {{ form.codigo.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.nombre.id_for_label }}">{{ form.nombre.label }}</label>
                {{ form.nombre }}
                {{ form.nombre.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.modulo.id_for_label }}">{{ form.modulo.label }}</label>
                {{ form.modulo }}
                {{ form.modulo.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.accion.id_for_label }}">{{ form.accion.label }}</label>
                {{ form.accion }}
                {{ form.accion.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.url_name.id_for_label }}">{{ form.url_name.label }}</label>
                {{ form.url_name }}
                {% comment %} <div class="form-text">Nombre de URL Django (opcional)</div> {% endcomment %}
                {{ form.url_name.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.vigente_desde.id_for_label }}">{{ form.vigente_desde.label }}</label>
                {{ form.vigente_desde }}
                {{ form.vigente_desde.errors }}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.vigente_hasta.id_for_label }}">{{ form.vigente_hasta.label }}</label>
                {{ form.vigente_hasta }}
                {{ form.vigente_hasta.errors }}
              </div>

              {% if object %}
              <div class="col-12">
                <div class="form-check">
                  {{ form.activo }} {{ form.activo.label_tag }}
                </div>
                {{ form.activo.errors }}
              </div>
              {% else %}
                {{ form.activo }}
              {% endif %}
            </div>

            <div class="mt-4">
              <button class="btn btn-custom" type="submit">
                {% if object %}Actualizar{% else %}Guardar{% endif %}
              </button>
              <a href="{% url 'permiso_list' %}" class="btn btn-secondary">Cancelar</a>
            </div>
          </form>
        {% comment %} {% else %}
          <div class="alert alert-warning mt-3">No ten√©s permiso para crear o editar permisos.</div>
        {% endif %} {% endcomment %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
